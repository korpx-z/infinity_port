{"version":3,"file":"HandleTooltip.js","sources":["../../../../src/components/Slider/HandleTooltip.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport Tooltip from 'rc-tooltip';\nimport React, { useEffect, useRef } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\n\ninterface RCTooltipRef {\n  // rc-tooltip's ref is essentially untyped, so we be cautious by saying the function is\n  // potentially undefined which, given rc's track record, seems likely :)\n  forcePopupAlign?: () => {};\n}\n\nconst HandleTooltip = (props: {\n  value: number;\n  children: React.ReactElement;\n  visible: boolean;\n  placement: 'top' | 'right';\n  tipFormatter?: (value: number) => React.ReactNode;\n}) => {\n  const { value, children, visible, placement, tipFormatter, ...restProps } = props;\n\n  const tooltipRef = useRef<RCTooltipRef>();\n  const rafRef = useRef<number | null>(null);\n  const styles = useStyles2(tooltipStyles);\n\n  function cancelKeepAlign() {\n    if (rafRef.current !== null) {\n      cancelAnimationFrame(rafRef.current);\n    }\n  }\n\n  function keepAlign() {\n    rafRef.current = requestAnimationFrame(() => {\n      tooltipRef.current?.forcePopupAlign?.();\n    });\n  }\n\n  useEffect(() => {\n    if (visible) {\n      keepAlign();\n    } else {\n      cancelKeepAlign();\n    }\n\n    return cancelKeepAlign;\n  }, [value, visible]);\n\n  return (\n    <Tooltip\n      overlayClassName={styles.tooltip}\n      placement={placement}\n      overlay={tipFormatter ?? value}\n      overlayInnerStyle={{ minHeight: 'auto' }}\n      ref={tooltipRef}\n      visible={visible}\n      {...restProps}\n    >\n      {children}\n    </Tooltip>\n  );\n};\n\nconst tooltipStyles = (theme: GrafanaTheme2) => {\n  return {\n    tooltip: css({\n      position: 'absolute',\n      display: 'block',\n      visibility: 'visible',\n      fontSize: theme.typography.bodySmall.fontSize,\n      opacity: 0.9,\n      padding: 3,\n    }),\n  };\n};\n\nexport default HandleTooltip;\n"],"names":["_a","React"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcM,MAAA,aAAA,GAAgB,CAAC,KAMjB,KAAA;AACJ,EAAA,MAA4E,EAApE,GAAA,KAAA,EAAA,EAAA,KAAA,EAAO,QAAU,EAAA,OAAA,EAAS,WAAW,YArB/C,EAAA,GAqB8E,EAAd,EAAA,SAAA,GAAA,SAAA,CAAc,EAAd,EAAA,CAAtD,OAAO,EAAA,UAAA,EAAU,WAAS,WAAW,EAAA,cAAA,CAAA,CAAA,CAAA;AAE7C,EAAA,MAAM,aAAa,MAAqB,EAAA,CAAA;AACxC,EAAM,MAAA,MAAA,GAAS,OAAsB,IAAI,CAAA,CAAA;AACzC,EAAM,MAAA,MAAA,GAAS,WAAW,aAAa,CAAA,CAAA;AAEvC,EAAA,SAAS,eAAkB,GAAA;AACzB,IAAI,IAAA,MAAA,CAAO,YAAY,IAAM,EAAA;AAC3B,MAAA,oBAAA,CAAqB,OAAO,OAAO,CAAA,CAAA;AAAA,KACrC;AAAA,GACF;AAEA,EAAA,SAAS,SAAY,GAAA;AACnB,IAAO,MAAA,CAAA,OAAA,GAAU,sBAAsB,MAAM;AAlCjD,MAAA,IAAAA,GAAA,EAAA,EAAA,CAAA;AAmCM,MAAA,CAAA,EAAA,GAAA,CAAAA,MAAA,UAAW,CAAA,OAAA,KAAX,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,GAAAA,CAAoB,oBAApB,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,EAAAA,CAAAA,IAAAA,CAAAA,GAAAA,CAAAA,CAAAA;AAAA,KACD,CAAA,CAAA;AAAA,GACH;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,IAAI,OAAS,EAAA;AACX,MAAU,SAAA,EAAA,CAAA;AAAA,KACL,MAAA;AACL,MAAgB,eAAA,EAAA,CAAA;AAAA,KAClB;AAEA,IAAO,OAAA,eAAA,CAAA;AAAA,GACN,EAAA,CAAC,KAAO,EAAA,OAAO,CAAC,CAAA,CAAA;AAEnB,EACE,uBAAAC,cAAA,CAAA,aAAA;AAAA,IAAC,OAAA;AAAA,IAAA,cAAA,CAAA;AAAA,MACC,kBAAkB,MAAO,CAAA,OAAA;AAAA,MACzB,SAAA;AAAA,MACA,SAAS,YAAgB,IAAA,IAAA,GAAA,YAAA,GAAA,KAAA;AAAA,MACzB,iBAAA,EAAmB,EAAE,SAAA,EAAW,MAAO,EAAA;AAAA,MACvC,GAAK,EAAA,UAAA;AAAA,MACL,OAAA;AAAA,KACI,EAAA,SAAA,CAAA;AAAA,IAEH,QAAA;AAAA,GACH,CAAA;AAEJ,EAAA;AAEA,MAAM,aAAA,GAAgB,CAAC,KAAyB,KAAA;AAC9C,EAAO,OAAA;AAAA,IACL,SAAS,GAAI,CAAA;AAAA,MACX,QAAU,EAAA,UAAA;AAAA,MACV,OAAS,EAAA,OAAA;AAAA,MACT,UAAY,EAAA,SAAA;AAAA,MACZ,QAAA,EAAU,KAAM,CAAA,UAAA,CAAW,SAAU,CAAA,QAAA;AAAA,MACrC,OAAS,EAAA,GAAA;AAAA,MACT,OAAS,EAAA,CAAA;AAAA,KACV,CAAA;AAAA,GACH,CAAA;AACF,CAAA;;;;"}