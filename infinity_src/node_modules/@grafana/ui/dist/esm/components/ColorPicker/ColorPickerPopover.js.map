{"version":3,"file":"ColorPickerPopover.js","sources":["../../../../src/components/ColorPicker/ColorPickerPopover.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport { FocusScope } from '@react-aria/focus';\nimport React, { Component } from 'react';\n\nimport { GrafanaTheme2, colorManipulator } from '@grafana/data';\n\nimport { stylesFactory, withTheme2 } from '../../themes';\nimport { Themeable2 } from '../../types/theme';\nimport { PopoverContentProps } from '../Tooltip';\n\nimport { NamedColorsPalette } from './NamedColorsPalette';\nimport SpectrumPalette from './SpectrumPalette';\n\nexport type ColorPickerChangeHandler = (color: string) => void;\n\nexport interface ColorPickerProps extends Themeable2 {\n  color: string;\n  onChange: ColorPickerChangeHandler;\n\n  enableNamedColors?: boolean;\n}\n\nexport interface Props<T> extends ColorPickerProps, PopoverContentProps {\n  customPickers?: T;\n}\n\ntype PickerType = 'palette' | 'spectrum';\n\nexport interface CustomPickersDescriptor {\n  [key: string]: {\n    tabComponent: React.ComponentType<ColorPickerProps>;\n    name: string;\n  };\n}\n\ninterface State<T> {\n  activePicker: PickerType | keyof T;\n}\n\nclass UnThemedColorPickerPopover<T extends CustomPickersDescriptor> extends Component<Props<T>, State<T>> {\n  constructor(props: Props<T>) {\n    super(props);\n    this.state = {\n      activePicker: 'palette',\n    };\n  }\n\n  getTabClassName = (tabName: PickerType | keyof T) => {\n    const { activePicker } = this.state;\n    return `ColorPickerPopover__tab ${activePicker === tabName && 'ColorPickerPopover__tab--active'}`;\n  };\n\n  handleChange = (color: string) => {\n    const { onChange, enableNamedColors, theme } = this.props;\n    if (enableNamedColors) {\n      return onChange(color);\n    }\n    onChange(colorManipulator.asHexString(theme.visualization.getColorByName(color)));\n  };\n\n  onTabChange = (tab: PickerType | keyof T) => {\n    return () => this.setState({ activePicker: tab });\n  };\n\n  renderPicker = () => {\n    const { activePicker } = this.state;\n    const { color } = this.props;\n\n    switch (activePicker) {\n      case 'spectrum':\n        return <SpectrumPalette color={color} onChange={this.handleChange} />;\n      case 'palette':\n        return <NamedColorsPalette color={color} onChange={this.handleChange} />;\n      default:\n        return this.renderCustomPicker(activePicker);\n    }\n  };\n\n  renderCustomPicker = (tabKey: keyof T) => {\n    const { customPickers, color, theme } = this.props;\n    if (!customPickers) {\n      return null;\n    }\n\n    return React.createElement(customPickers[tabKey].tabComponent, {\n      color,\n      theme,\n      onChange: this.handleChange,\n    });\n  };\n\n  renderCustomPickerTabs = () => {\n    const { customPickers } = this.props;\n\n    if (!customPickers) {\n      return null;\n    }\n\n    return (\n      <>\n        {Object.keys(customPickers).map((key) => {\n          return (\n            <button className={this.getTabClassName(key)} onClick={this.onTabChange(key)} key={key}>\n              {customPickers[key].name}\n            </button>\n          );\n        })}\n      </>\n    );\n  };\n\n  render() {\n    const { theme } = this.props;\n    const styles = getStyles(theme);\n    return (\n      <FocusScope contain restoreFocus autoFocus>\n        {/*\n          tabIndex=-1 is needed here to support highlighting text within the picker when using FocusScope\n          see https://github.com/adobe/react-spectrum/issues/1604#issuecomment-781574668\n        */}\n        <div tabIndex={-1} className={styles.colorPickerPopover}>\n          <div className={styles.colorPickerPopoverTabs}>\n            <button className={this.getTabClassName('palette')} onClick={this.onTabChange('palette')}>\n              Colors\n            </button>\n            <button className={this.getTabClassName('spectrum')} onClick={this.onTabChange('spectrum')}>\n              Custom\n            </button>\n            {this.renderCustomPickerTabs()}\n          </div>\n          <div className={styles.colorPickerPopoverContent}>{this.renderPicker()}</div>\n        </div>\n      </FocusScope>\n    );\n  }\n}\n\nexport const ColorPickerPopover = withTheme2(UnThemedColorPickerPopover);\nColorPickerPopover.displayName = 'ColorPickerPopover';\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2) => {\n  return {\n    colorPickerPopover: css`\n      border-radius: ${theme.shape.borderRadius()};\n      box-shadow: ${theme.shadows.z3};\n      background: ${theme.colors.background.primary};\n      border: 1px solid ${theme.colors.border.medium};\n\n      .ColorPickerPopover__tab {\n        width: 50%;\n        text-align: center;\n        padding: ${theme.spacing(1, 0)};\n        background: ${theme.colors.background.secondary};\n        color: ${theme.colors.text.secondary};\n        font-size: ${theme.typography.bodySmall.fontSize};\n        cursor: pointer;\n        border: none;\n\n        &:focus:not(:focus-visible) {\n          outline: none;\n          box-shadow: none;\n        }\n\n        :focus-visible {\n          position: relative;\n        }\n      }\n\n      .ColorPickerPopover__tab--active {\n        color: ${theme.colors.text.primary};\n        font-weight: ${theme.typography.fontWeightMedium};\n        background: ${theme.colors.background.primary};\n      }\n    `,\n    colorPickerPopoverContent: css`\n      width: 246px;\n      font-size: ${theme.typography.bodySmall.fontSize};\n      min-height: 184px;\n      padding: ${theme.spacing(1)};\n      display: flex;\n      flex-direction: column;\n    `,\n    colorPickerPopoverTabs: css`\n      display: flex;\n      width: 100%;\n      border-radius: ${theme.shape.borderRadius()} ${theme.shape.borderRadius()} 0 0;\n    `,\n  };\n});\n"],"names":["React"],"mappings":"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"}