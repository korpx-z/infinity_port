{"version":3,"file":"ColorPicker.js","sources":["../../../../src/components/ColorPicker/ColorPicker.tsx"],"sourcesContent":["import { css } from '@emotion/css';\nimport React, { Component, createRef } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { withTheme2, stylesFactory } from '../../themes';\nimport { closePopover } from '../../utils/closePopover';\nimport { Popover } from '../Tooltip/Popover';\nimport { PopoverController } from '../Tooltip/PopoverController';\n\nimport { ColorPickerPopover, ColorPickerProps } from './ColorPickerPopover';\nimport { ColorSwatch } from './ColorSwatch';\nimport { SeriesColorPickerPopover } from './SeriesColorPickerPopover';\n\n/**\n * If you need custom trigger for the color picker you can do that with a render prop pattern and supply a function\n * as a child. You will get show/hide function which you can map to desired interaction (like onClick or onMouseLeave)\n * and a ref which needs to be passed to an HTMLElement for correct positioning. If you want to use class or functional\n * component as a custom trigger you will need to forward the reference to first HTMLElement child.\n */\ntype ColorPickerTriggerRenderer = (props: {\n  // This should be a React.RefObject<HTMLElement> but due to how object refs are defined you cannot downcast from that\n  // to a specific type like React.RefObject<HTMLDivElement> even though it would be fine in runtime.\n  ref: React.RefObject<any>;\n  showColorPicker: () => void;\n  hideColorPicker: () => void;\n}) => React.ReactNode;\n\nexport const colorPickerFactory = <T extends ColorPickerProps>(\n  popover: React.ComponentType<React.PropsWithChildren<T>>,\n  displayName = 'ColorPicker'\n) => {\n  return class ColorPicker extends Component<T & { children?: ColorPickerTriggerRenderer }> {\n    static displayName = displayName;\n    pickerTriggerRef = createRef<any>();\n\n    render() {\n      const { theme, children, onChange } = this.props;\n      const styles = getStyles(theme);\n      const popoverElement = React.createElement(popover, {\n        ...{ ...this.props, children: null },\n        onChange,\n      });\n\n      return (\n        <PopoverController content={popoverElement} hideAfter={300}>\n          {(showPopper, hidePopper, popperProps) => {\n            return (\n              <>\n                {this.pickerTriggerRef.current && (\n                  <Popover\n                    {...popperProps}\n                    referenceElement={this.pickerTriggerRef.current}\n                    wrapperClassName={styles.colorPicker}\n                    onMouseLeave={hidePopper}\n                    onMouseEnter={showPopper}\n                    onKeyDown={(event) => closePopover(event, hidePopper)}\n                  />\n                )}\n\n                {children ? (\n                  // Children have a bit weird type due to intersection used in the definition so we need to cast here,\n                  // but the definition is correct and should not allow to pass a children that does not conform to\n                  // ColorPickerTriggerRenderer type.\n                  (children as ColorPickerTriggerRenderer)({\n                    ref: this.pickerTriggerRef,\n                    showColorPicker: showPopper,\n                    hideColorPicker: hidePopper,\n                  })\n                ) : (\n                  <ColorSwatch\n                    ref={this.pickerTriggerRef}\n                    onClick={showPopper}\n                    onMouseLeave={hidePopper}\n                    color={theme.visualization.getColorByName(this.props.color || '#000000')}\n                  />\n                )}\n              </>\n            );\n          }}\n        </PopoverController>\n      );\n    }\n  };\n};\n\nexport const ColorPicker = withTheme2(colorPickerFactory(ColorPickerPopover, 'ColorPicker'));\nexport const SeriesColorPicker = withTheme2(colorPickerFactory(SeriesColorPickerPopover, 'SeriesColorPicker'));\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2) => {\n  return {\n    colorPicker: css`\n      position: absolute;\n      z-index: ${theme.zIndex.tooltip};\n      color: ${theme.colors.text.primary};\n      max-width: 400px;\n      font-size: ${theme.typography.size.sm};\n      // !important because these styles are also provided to popper via .popper classes from Tooltip component\n      // hope to get rid of those soon\n      padding: 15px !important;\n      & [data-placement^='top'] {\n        padding-left: 0 !important;\n        padding-right: 0 !important;\n      }\n      & [data-placement^='bottom'] {\n        padding-left: 0 !important;\n        padding-right: 0 !important;\n      }\n      & [data-placement^='left'] {\n        padding-top: 0 !important;\n      }\n      & [data-placement^='right'] {\n        padding-top: 0 !important;\n      }\n    `,\n  };\n});\n"],"names":["React"],"mappings":"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"}