{"version":3,"file":"VizLegendTable.js","sources":["../../../../src/components/VizLegend/VizLegendTable.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport { orderBy } from 'lodash';\nimport React from 'react';\n\nimport { DisplayValue, GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes/ThemeContext';\nimport { Icon } from '../Icon/Icon';\n\nimport { LegendTableItem } from './VizLegendTableItem';\nimport { VizLegendTableProps } from './types';\n\n/**\n * @internal\n */\nexport const VizLegendTable = <T extends unknown>({\n  items,\n  sortBy: sortKey,\n  sortDesc,\n  itemRenderer,\n  className,\n  onToggleSort,\n  onLabelClick,\n  onLabelMouseOver,\n  onLabelMouseOut,\n  readonly,\n}: VizLegendTableProps<T>): JSX.Element => {\n  const styles = useStyles2(getStyles);\n  const stats: Record<string, DisplayValue> = {};\n\n  for (const item of items) {\n    if (item.getDisplayValues) {\n      for (const displayValue of item.getDisplayValues()) {\n        stats[displayValue.title ?? '?'] = displayValue;\n      }\n    }\n  }\n\n  const sortedItems = sortKey\n    ? orderBy(\n        items,\n        (item) => {\n          if (item.getDisplayValues) {\n            const stat = item.getDisplayValues().filter((stat) => stat.title === sortKey)[0];\n            return stat && stat.numeric;\n          }\n          return undefined;\n        },\n        sortDesc ? 'desc' : 'asc'\n      )\n    : items;\n\n  if (!itemRenderer) {\n    /* eslint-disable-next-line react/display-name */\n    itemRenderer = (item, index) => (\n      <LegendTableItem\n        key={`${item.label}-${index}`}\n        item={item}\n        onLabelClick={onLabelClick}\n        onLabelMouseOver={onLabelMouseOver}\n        onLabelMouseOut={onLabelMouseOut}\n        readonly={readonly}\n      />\n    );\n  }\n\n  return (\n    <table className={cx(styles.table, className)}>\n      <thead>\n        <tr>\n          <th></th>\n          {Object.keys(stats).map((columnTitle) => {\n            const displayValue = stats[columnTitle];\n            return (\n              <th\n                title={displayValue.description}\n                key={columnTitle}\n                className={cx(styles.header, onToggleSort && styles.headerSortable, {\n                  [styles.withIcon]: sortKey === columnTitle,\n                })}\n                onClick={() => {\n                  if (onToggleSort) {\n                    onToggleSort(columnTitle);\n                  }\n                }}\n              >\n                {columnTitle}\n                {sortKey === columnTitle && <Icon size=\"xs\" name={sortDesc ? 'angle-down' : 'angle-up'} />}\n              </th>\n            );\n          })}\n        </tr>\n      </thead>\n      <tbody>{sortedItems.map(itemRenderer!)}</tbody>\n    </table>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  table: css`\n    width: 100%;\n    th:first-child {\n      width: 100%;\n      border-bottom: 1px solid ${theme.colors.border.weak};\n    }\n  `,\n  header: css`\n    color: ${theme.colors.primary.text};\n    font-weight: ${theme.typography.fontWeightMedium};\n    border-bottom: 1px solid ${theme.colors.border.weak};\n    padding: ${theme.spacing(0.25, 1, 0.25, 1)};\n    font-size: ${theme.typography.bodySmall.fontSize};\n    text-align: right;\n    white-space: nowrap;\n  `,\n  // This needs to be padding-right - icon size(xs==12) to avoid jumping\n  withIcon: css`\n    padding-right: 4px;\n  `,\n  headerSortable: css`\n    cursor: pointer;\n  `,\n});\n"],"names":["stat","React"],"mappings":"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"}