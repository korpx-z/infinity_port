{"version":3,"file":"DefaultCell.js","sources":["../../../../src/components/Table/DefaultCell.tsx"],"sourcesContent":["import { cx } from '@emotion/css';\nimport React, { ReactElement } from 'react';\nimport tinycolor from 'tinycolor2';\n\nimport { DisplayValue, formattedValueToString } from '@grafana/data';\nimport { TableCellBackgroundDisplayMode, TableCellOptions } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes';\nimport { getCellLinks, getTextColorForAlphaBackground } from '../../utils';\nimport { clearLinkButtonStyles } from '../Button';\nimport { DataLinksContextMenu } from '../DataLinks/DataLinksContextMenu';\n\nimport { CellActions } from './CellActions';\nimport { TableStyles } from './styles';\nimport { TableCellDisplayMode, TableCellProps, TableFieldOptions } from './types';\nimport { getCellOptions } from './utils';\n\nexport const DefaultCell = (props: TableCellProps) => {\n  const { field, cell, tableStyles, row, cellProps } = props;\n\n  const inspectEnabled = Boolean((field.config.custom as TableFieldOptions)?.inspect);\n  const displayValue = field.display!(cell.value);\n\n  let value: string | ReactElement;\n  if (React.isValidElement(cell.value)) {\n    value = cell.value;\n  } else {\n    value = formattedValueToString(displayValue);\n  }\n\n  const showFilters = props.onCellFilterAdded && field.config.filterable;\n  const showActions = (showFilters && cell.value !== undefined) || inspectEnabled;\n  const cellOptions = getCellOptions(field);\n  const cellStyle = getCellStyle(tableStyles, cellOptions, displayValue, inspectEnabled);\n  const hasLinks = Boolean(getCellLinks(field, row)?.length);\n  const clearButtonStyle = useStyles2(clearLinkButtonStyles);\n\n  return (\n    <div {...cellProps} className={cellStyle}>\n      {!hasLinks && <div className={tableStyles.cellText}>{value}</div>}\n\n      {hasLinks && (\n        <DataLinksContextMenu links={() => getCellLinks(field, row) || []}>\n          {(api) => {\n            if (api.openMenu) {\n              return (\n                <button\n                  className={cx(clearButtonStyle, getLinkStyle(tableStyles, cellOptions, api.targetClassName))}\n                  onClick={api.openMenu}\n                >\n                  {value}\n                </button>\n              );\n            } else {\n              return <div className={getLinkStyle(tableStyles, cellOptions, api.targetClassName)}>{value}</div>;\n            }\n          }}\n        </DataLinksContextMenu>\n      )}\n\n      {showActions && <CellActions {...props} previewMode=\"text\" showFilters={showFilters} />}\n    </div>\n  );\n};\n\nfunction getCellStyle(\n  tableStyles: TableStyles,\n  cellOptions: TableCellOptions,\n  displayValue: DisplayValue,\n  disableOverflowOnHover = false\n) {\n  // How much to darken elements depends upon if we're in dark mode\n  const darkeningFactor = tableStyles.theme.isDark ? 1 : -0.7;\n\n  // Setup color variables\n  let textColor: string | undefined = undefined;\n  let bgColor: string | undefined = undefined;\n\n  if (cellOptions.type === TableCellDisplayMode.ColorText) {\n    textColor = displayValue.color;\n  } else if (cellOptions.type === TableCellDisplayMode.ColorBackground) {\n    const mode = cellOptions.mode ?? TableCellBackgroundDisplayMode.Gradient;\n\n    if (mode === TableCellBackgroundDisplayMode.Basic) {\n      textColor = getTextColorForAlphaBackground(displayValue.color!, tableStyles.theme.isDark);\n      bgColor = tinycolor(displayValue.color).toRgbString();\n    } else if (mode === TableCellBackgroundDisplayMode.Gradient) {\n      const bgColor2 = tinycolor(displayValue.color)\n        .darken(10 * darkeningFactor)\n        .spin(5);\n      textColor = getTextColorForAlphaBackground(displayValue.color!, tableStyles.theme.isDark);\n      bgColor = `linear-gradient(120deg, ${bgColor2.toRgbString()}, ${displayValue.color})`;\n    }\n  }\n\n  // If we have definied colors return those styles\n  // Otherwise we return default styles\n  if (textColor !== undefined || bgColor !== undefined) {\n    return tableStyles.buildCellContainerStyle(textColor, bgColor, !disableOverflowOnHover);\n  }\n\n  return disableOverflowOnHover ? tableStyles.cellContainerNoOverflow : tableStyles.cellContainer;\n}\n\nfunction getLinkStyle(tableStyles: TableStyles, cellOptions: TableCellOptions, targetClassName: string | undefined) {\n  if (cellOptions.type === TableCellDisplayMode.Auto) {\n    return cx(tableStyles.cellLink, targetClassName);\n  }\n\n  return cx(tableStyles.cellLinkForColoredCell, targetClassName);\n}\n"],"names":["React"],"mappings":"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"}