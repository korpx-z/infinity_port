{"version":3,"file":"hooks.js","sources":["../../../../src/components/Table/hooks.ts"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { VariableSizeList } from 'react-window';\n\nimport { DataFrame } from '@grafana/data';\n\nimport { GrafanaTableState } from './types';\n\n/** \n  To have the custom vertical scrollbar always visible (https://github.com/grafana/grafana/issues/52136),\n  we need to bring the element from the VariableSizeList scope to the outer Table container scope,\n  because the VariableSizeList scope has overflow. By moving scrollbar to container scope we will have\n  it always visible since the entire width is in view.\n  Select the scrollbar element from the VariableSizeList scope\n */\nexport function useFixScrollbarContainer(\n  variableSizeListScrollbarRef: React.RefObject<HTMLDivElement>,\n  tableDivRef: React.RefObject<HTMLDivElement>\n) {\n  useEffect(() => {\n    const listVerticalScrollbarHTML = (variableSizeListScrollbarRef.current as HTMLDivElement)?.querySelector(\n      '.track-vertical'\n    );\n\n    // Select Table custom scrollbars\n    const tableScrollbarView = (tableDivRef.current as HTMLDivElement)?.firstChild;\n\n    //If they exists, move the scrollbar element to the Table container scope\n    if (tableScrollbarView && listVerticalScrollbarHTML) {\n      listVerticalScrollbarHTML?.remove();\n      (tableScrollbarView as HTMLDivElement).querySelector(':scope > .track-vertical')?.remove();\n\n      (tableScrollbarView as HTMLDivElement).append(listVerticalScrollbarHTML as Node);\n    }\n  });\n}\n\n/**\n  react-table caches the height of cells so we need to reset them when expanding/collapsing rows\n   We need to take the minimum of the current expanded indexes and the previous expandedIndexes array to account\n  for collapsed rows, since they disappear from expandedIndexes but still keep their expanded height\n */\nexport function useResetVariableListSizeCache(\n  extendedState: GrafanaTableState,\n  listRef: React.RefObject<VariableSizeList>,\n  data: DataFrame\n) {\n  useEffect(() => {\n    if (extendedState.lastExpandedIndex !== undefined) {\n      listRef.current?.resetAfterIndex(Math.max(extendedState.lastExpandedIndex - 1, 0));\n      return;\n    }\n  }, [extendedState.lastExpandedIndex, extendedState.toggleRowExpandedCounter, listRef, data]);\n}\n"],"names":[],"mappings":";;AAcgB,SAAA,wBAAA,CACd,8BACA,WACA,EAAA;AACA,EAAA,SAAA,CAAU,MAAM;AAlBlB,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA;AAmBI,IAAM,MAAA,yBAAA,GAAA,CAA6B,EAA6B,GAAA,4BAAA,CAAA,OAAA,KAA7B,IAAyD,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,aAAA;AAAA,MAC1F,iBAAA;AAAA,KAAA,CAAA;AAIF,IAAM,MAAA,kBAAA,GAAA,CAAsB,EAAY,GAAA,WAAA,CAAA,OAAA,KAAZ,IAAwC,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,UAAA,CAAA;AAGpE,IAAA,IAAI,sBAAsB,yBAA2B,EAAA;AACnD,MAA2B,yBAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,yBAAA,CAAA,MAAA,EAAA,CAAA;AAC3B,MAAA,CAAC,EAAsC,GAAA,kBAAA,CAAA,aAAA,CAAc,0BAA0B,CAAA,KAA9E,IAAiF,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,MAAA,EAAA,CAAA;AAElF,MAAC,kBAAA,CAAsC,OAAO,yBAAiC,CAAA,CAAA;AAAA,KACjF;AAAA,GACD,CAAA,CAAA;AACH,CAAA;AAOgB,SAAA,6BAAA,CACd,aACA,EAAA,OAAA,EACA,IACA,EAAA;AACA,EAAA,SAAA,CAAU,MAAM;AA9ClB,IAAA,IAAA,EAAA,CAAA;AA+CI,IAAI,IAAA,aAAA,CAAc,sBAAsB,KAAW,CAAA,EAAA;AACjD,MAAQ,CAAA,EAAA,GAAA,OAAA,CAAA,OAAA,KAAR,mBAAiB,eAAgB,CAAA,IAAA,CAAK,IAAI,aAAc,CAAA,iBAAA,GAAoB,GAAG,CAAC,CAAA,CAAA,CAAA;AAChF,MAAA,OAAA;AAAA,KACF;AAAA,GACF,EAAG,CAAC,aAAc,CAAA,iBAAA,EAAmB,cAAc,wBAA0B,EAAA,OAAA,EAAS,IAAI,CAAC,CAAA,CAAA;AAC7F;;;;"}