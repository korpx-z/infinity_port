{"version":3,"file":"limit.js","sources":["../../../../src/transformations/transformers/limit.ts"],"sourcesContent":["import { map } from 'rxjs/operators';\n\nimport { DataTransformerInfo } from '../../types';\nimport { ArrayVector } from '../../vector/ArrayVector';\n\nimport { DataTransformerID } from './ids';\n\nexport interface LimitTransformerOptions {\n  limitField?: number;\n}\n\nconst DEFAULT_LIMIT_FIELD = 10;\n\nexport const limitTransformer: DataTransformerInfo<LimitTransformerOptions> = {\n  id: DataTransformerID.limit,\n  name: 'Limit',\n  description: 'Limit the number of items to the top N',\n  defaultOptions: {\n    limitField: DEFAULT_LIMIT_FIELD,\n  },\n\n  operator: (options) => (source) =>\n    source.pipe(\n      map((data) => {\n        const limitFieldMatch = options.limitField || DEFAULT_LIMIT_FIELD;\n        return data.map((frame) => {\n          if (frame.length > limitFieldMatch) {\n            return {\n              ...frame,\n              fields: frame.fields.map((f) => {\n                const vals = f.values.toArray();\n                return {\n                  ...f,\n                  values: new ArrayVector(vals.slice(0, limitFieldMatch)),\n                };\n              }),\n              length: limitFieldMatch,\n            };\n          }\n\n          return frame;\n        });\n      })\n    ),\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAWA,MAAM,mBAAsB,GAAA,EAAA,CAAA;AAErB,MAAM,gBAAiE,GAAA;AAAA,EAC5E,IAAI,iBAAkB,CAAA,KAAA;AAAA,EACtB,IAAM,EAAA,OAAA;AAAA,EACN,WAAa,EAAA,wCAAA;AAAA,EACb,cAAgB,EAAA;AAAA,IACd,UAAY,EAAA,mBAAA;AAAA,GACd;AAAA,EAEA,QAAU,EAAA,CAAC,OAAY,KAAA,CAAC,WACtB,MAAO,CAAA,IAAA;AAAA,IACL,GAAA,CAAI,CAAC,IAAS,KAAA;AACZ,MAAM,MAAA,eAAA,GAAkB,QAAQ,UAAc,IAAA,mBAAA,CAAA;AAC9C,MAAO,OAAA,IAAA,CAAK,GAAI,CAAA,CAAC,KAAU,KAAA;AACzB,QAAI,IAAA,KAAA,CAAM,SAAS,eAAiB,EAAA;AAClC,UAAA,OAAO,iCACF,KADE,CAAA,EAAA;AAAA,YAEL,MAAQ,EAAA,KAAA,CAAM,MAAO,CAAA,GAAA,CAAI,CAAC,CAAM,KAAA;AAC9B,cAAM,MAAA,IAAA,GAAO,CAAE,CAAA,MAAA,CAAO,OAAQ,EAAA,CAAA;AAC9B,cAAA,OAAO,iCACF,CADE,CAAA,EAAA;AAAA,gBAEL,QAAQ,IAAI,WAAA,CAAY,KAAK,KAAM,CAAA,CAAA,EAAG,eAAe,CAAC,CAAA;AAAA,eACxD,CAAA,CAAA;AAAA,aACD,CAAA;AAAA,YACD,MAAQ,EAAA,eAAA;AAAA,WACV,CAAA,CAAA;AAAA,SACF;AAEA,QAAO,OAAA,KAAA,CAAA;AAAA,OACR,CAAA,CAAA;AAAA,KACF,CAAA;AAAA,GACH;AACJ;;;;"}